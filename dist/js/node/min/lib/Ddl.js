!function(t){"use strict";var e=require("./Querable.js").Querable,_=require("./Table.js").Table,i=require("../param/Error.js").ERROR,n=function(){e.apply(this,arguments),this._set_create_table=!1,this._set_drop_table=!1,this._set_create_index=!1,this._set_drop_index=!1,this._table_name="",this._index_name="",this._option={}};n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!0,writable:!1,configurable:!0}}),n.prototype.create_table=n.prototype.createTable=function(t,e){if(this._set_create_table||this._set_drop_table||this._set_create_index||this._set_drop_index)throw i.invalid_description("create_table");if(this._check_arguments&&(arguments.length<1||arguments.length>2))throw i.invalid_argument("create_table");return this._set_create_table=!0,this._table_name=t,this._option=e,this},n.prototype.drop_table=n.prototype.dropTable=function(t){if(this._set_create_table||this._set_drop_table||this._set_create_index||this._set_drop_index)throw i.invalid_description("drop_table");if(this._check_arguments&&1!==arguments.length)throw i.invalid_argument("drop_table");return this._set_drop_table=!0,this._table_name=t,this},n.prototype.create_index=n.prototype.createIndex=function(t,e,_){if(this._set_create_table||this._set_drop_table||this._set_create_index||this._set_drop_index)throw i.invalid_description("create_index");if(this._check_arguments&&3!==arguments.length)throw i.invalid_argument("create_index");return this._set_create_index=!0,this._table_name=t,this._index_name=e,this._option=_,this},n.prototype.drop_index=n.prototype.dropIndex=function(t,e){if(this._set_create_table||this._set_drop_table||this._set_create_index||this._set_drop_index)throw i.invalid_description("drop_index");if(this._check_arguments&&2!==arguments.length)throw i.invalid_argument("create_index");return this._set_drop_index=!0,this._table_name=t,this._index_name=e,this},n.prototype._isRunnable=function(){return this._set_create_table||this._set_drop_table||this._set_create_index||this._set_drop_index},n.prototype.exec=function(t,e,n){if(!this._isRunnable())throw i.invalid_description("exec");var a=this,s=this._sli2_object,r="function"==typeof e?e:function(){},o="function"==typeof n?n:function(){};if(void 0===s||null===s)throw i.querable_is_not_initialized;var l=function(){r()},h=function(t){return function(e){o(i.ddl_exec_error(t+" / "+e.message))}},c=function(){},d="function"==typeof t?t:l;if(this._set_create_table)if(c=h("create_table"),s.tables[this._table_name])c(i.table_already_exist(this._table_name));else{var b=new _(this._table_name,null,s);b.create(this._option,function(){var t="";s.tables[a._table_name]=b,s.isUpgrading()?t=s.constructor.DEFAULT_UPGRADING_HANDLER:s.isTransacting()&&c(i.cannot_execute("create_table in transacting")),b.open(s.transactio,t),d(b,l,c),t||b.close(t)},c)}else this._set_drop_table?(c=h("drop_table"),s.tables[this._table_name]?s.tables[this._table_name].drop(function(){d(null,l,c)},c):c(i.table_not_exist(this._table_name))):this._set_create_index?(c=h("create_index"),s.tables[this._table_name]?s.tables[this._table_name].createIndex(this._index_name,this._option,function(){d(null,l,c)},c):c(i.table_not_exist(this._table_name))):this._set_drop_index&&(c=h("drop_index"),s.tables[this._table_name]?s.tables[this._table_name].dropIndex(this._index_name,function(){d(null,l,c)},c):c(i.table_not_exist(this._table_name)))},t.Ddl=n}(this);