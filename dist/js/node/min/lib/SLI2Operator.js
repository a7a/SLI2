!function(e){"use strict";var t=require("../param/Error.js").ERROR,n=require("./setFunction.js").setFunction,o=function(e){this._sli2_object=e,this._closed=!1};o.prototype.close=function(){this._sli2_object=null,this._closed=!0},o.prototype.add=function(e,n,o,r){if(this._closed)throw t.closed;var i=null,s=[],a=[],u="function"==typeof o?o:function(){},c="function"==typeof r?r:function(){};if(Array.isArray(n))for(var f=0,l=n.length;l>f;f+=1)s[f]=n[f];else s[0]=n;var d=function p(){i=e.add(s.shift()),i.onsuccess=function(e){a[a.length]=e.target.result,s.length>0?p():u(a)},i.onerror=function(e){var t=e.target.error;c("add: "+t.name+": "+t.message)}};d()},o.prototype.put=function(e,n,o,r){if(this._closed)throw t.closed;var i=null,s=[],a=[],u="function"==typeof o?o:function(){},c="function"==typeof r?r:function(){};if(Array.isArray(n))for(var f=0,l=n.length;l>f;f+=1)s[f]=n[f];else s[0]=n;var d=function p(){i=e.put(s.shift()),i.onsuccess=function(e){a[a.length]=e.target.result,s.length>0?p():u(a)},i.onerror=function(e){var t=e.target.error;c("put: "+t.name+": "+t.message)}};d()},o.prototype.selectAll=function(e,n,o,r){if(this._closed)throw t.closed;var i=[],s=e.openCursor(),a="function"==typeof o?o:function(){},u="function"==typeof r?r:function(){};n?(s.onsuccess=function(e){var t=e.target.result;if(t){var o={};o[n]=t.value,i[i.length]=o,t["continue"]()}else a(i)},s.onerror=function(e){var n=e.target.error;u(t.indexed_operation("selectAll: "+n.name+": "+n.message))}):(s.onsuccess=function(e){var t=e.target.result;t?(i[i.length]=t.value,t["continue"]()):a(i)},s.onerror=function(e){var n=e.target.error;u(t.indexed_operation("selectAll: "+n.name+": "+n.message))})},o.prototype.selectForStoresAndKeyRangesAndFilters=function(e,o,r,i,s,a,u){if(this._closed)throw t.closed;for(var c=[],f=[],l=[],d=[],p="function"==typeof a?a:function(){},h="function"==typeof u?u:function(){},g=[],v=0,y=e.length;y>v;v+=1)f[v]=e[v],l[v]=o[v],d[v]=r[v];var A=function(){if(f.length>0){var e=f.shift(),o=l.shift(),r=d.shift(),a=e.openCursor(o),u=n.setWithNoTableNameAndNoAlias;""!==i&&""!==s?u=n.setWithTableNameAndAlias:""!==i&&""===s?u=n.setWithTableName:""===i&&""!==s&&(u=n.setWithAlias),a.onsuccess=function(e){var t=e.target.result;if(t){var n=t.primaryKey+"";!~g.indexOf(n)&&u(t.value,c,r,i,s)&&(g[g.length]=n),t["continue"]()}else A()},a.onerror=function(e){var n=e.target.error;h(t.indexed_operation("selectForStoreAndKeyRangesAndFilter: "+n.name+": "+n.message))}}else p(c)};A()},o.prototype.deleteAll=function(e,n,o){if(this._closed)throw t.closed;var r="function"==typeof n?n:function(){},i="function"==typeof o?o:function(){},s=e.openCursor(),a=0;s.onsuccess=function(e){var t=e.target.result;t?(t["delete"](),a+=1,t["continue"]()):r(a)},s.onerror=function(e){var n=e.target.error;i(t.indexed_operation("deleteAll: "+n.name+": "+n.message))}},o.prototype.deleteForStoresAndKeyRangesAndFilters=function(e,n,o,r,i){if(this._closed)throw t.closed;for(var s="function"==typeof r?r:function(){},a="function"==typeof i?i:function(){},u=0,c=[],f=[],l=[],d=0,p=e.length;p>d;d+=1)c[d]=e[d],f[d]=n[d],l[d]=o[d];var h=function g(){if(c.length>0){var e=c.shift(),n=f.shift(),o=l.shift(),r=e.openCursor(n);r.onsuccess=function(e){var t=e.target.result;t?(o(t.value)&&(t["delete"](),u+=1),t["continue"]()):g()},r.onerror=function(e){var n=e.target.error;a(t.indexed_operation("deleteForStoreAndKeyRangesAndFilter: "+n.name+": "+n.message))}}else s(u)};h()},o.prototype.updateAll=function(e,n,o,r){if(this._closed)throw t.closed;var i=e.openCursor(),s=0,a="function"==typeof o?o:function(){},u="function"==typeof r?r:function(){};i.onsuccess=function(e){var t=e.target.result;if(t){var o=t.value;for(var r in n)o[r]=n[r];t.update(o),s+=1,t["continue"]()}else a(s)},i.onerror=function(e){var n=e.target.error;u(t.indexed_operation("updateAll: "+n.name+": "+n.message))}},o.prototype.updateForStoresAndKeyRangesAndFilters=function(e,n,o,r,i,s){if(this._closed)throw t.closed;for(var a=0,u=[],c=[],f=[],l="function"==typeof i?i:function(){},d="function"==typeof s?s:function(){},p=0,h=e.length;h>p;p+=1)u[p]=e[p],c[p]=n[p],f[p]=o[p];var g=function v(){if(c.length>0){var e=u.shift(),n=c.shift(),o=f.shift(),i=e.openCursor(n);i.onsuccess=function(e){var t=e.target.result;if(t){if(o(t.value)){var n=t.value;for(var i in r)n[i]=r[i];t.update(n),a+=1}t["continue"]()}else v()},i.onerror=function(e){var n=e.target.error;d(t.indexed_operation("updateForStoreAndKeyRangesAndFilter: "+n.name+": "+n.message))}}else l(a)};g()},e.SLI2Operator=o}(this);